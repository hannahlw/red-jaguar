$( document ).ready(function() {
  
  $('button#genre-picker').click(function(event){
    var data = {filter_by: this.textContent};
    var url = window.location.href + "filter";
    
    function makeUpdates(results){
      var boards = results.message.boards
      for(i = 0; i < boards.length; i++) {
      $('#content_'+ i + " " + 'a').attr('href', "/boards/"+boards[i].id).text(boards[i].name)
      }
      
    }

    $.ajax({
      type: 'POST',
      url: url,
      data: data,
      success: function(results){
        makeUpdates(results);
      },
      dataType: 'JSON'
    })
  })

//parse input of url, assign kind to link and dynamically change header color 
    $('#board_links_attributes_0_url').on('input', function(){
      if($('#board_links_attributes_0_url').val().match(/youtube.com/)){
        $('#board_links_attributes_0_kind').attr('value',2);
        $('#header_0').attr('class','card-header bgm-red');
      }
      else if($('#board_links_attributes_0_url').val().match(/twitter.com/)){
        $('#board_links_attributes_0_kind').attr('value',3)
        $('#header_0').attr('class','card-header bgm-blue');
      }
      else if($('#board_links_attributes_0_url').val().match(/soundcloud.com/)){
        $('#board_links_attributes_0_kind').attr('value',4)
        $('#header_0').attr('class','card-header bgm-orange');
      }
      else if($('#board_links_attributes_0_url').val().match(/.\s./)){
        $('#board_links_attributes_0_kind').attr('value',5)
        $('#header_0').attr('class','card-header bgm-green');
      }
      else {
        $('#header_0').attr('class','card-header bgm-indigo');
        $('#board_links_attributes_0_kind').attr('value',1)
      }
    })

    $('#board_links_attributes_1_url').on('input', function(){
      if($('#board_links_attributes_1_url').val().match(/youtube.com/)){
        $('#board_links_attributes_1_kind').attr('value',2);
        $('#header_1').attr('class','card-header bgm-red');
      }
      else if($('#board_links_attributes_1_url').val().match(/twitter.com/)){
        $('#board_links_attributes_1_kind').attr('value',3)
        $('#header_1').attr('class','card-header bgm-blue');
      }
      else if($('#board_links_attributes_1_url').val().match(/soundcloud.com/)){
        $('#board_links_attributes_1_kind').attr('value',4)
        $('#header_1').attr('class','card-header bgm-orange');
      }
      else if($('#board_links_attributes_1_url').val().match(/.\s./)){
        $('#board_links_attributes_1_kind').attr('value',5)
        $('#header_1').attr('class','card-header bgm-green');
      }
      else {
        $('#header_1').attr('class','card-header bgm-indigo');
        $('#board_links_attributes_1_kind').attr('value',1)
      }
    })

    $('#board_links_attributes_2_url').on('input', function(){
      if($('#board_links_attributes_2_url').val().match(/youtube.com/)){
        $('#board_links_attributes_2_kind').attr('value',2);
        $('#header_2').attr('class','card-header bgm-red');
      }
      else if($('#board_links_attributes_2_url').val().match(/twitter.com/)){
        $('#board_links_attributes_2_kind').attr('value',3)
        $('#header_2').attr('class','card-header bgm-blue');
      }
      else if($('#board_links_attributes_2_url').val().match(/soundcloud.com/)){
        $('#board_links_attributes_2_kind').attr('value',4)
        $('#header_2').attr('class','card-header bgm-orange');
      }
      else if($('#board_links_attributes_2_url').val().match(/.\s./)){
        $('#board_links_attributes_2_kind').attr('value',5)
        $('#header_2').attr('class','card-header bgm-green');
      }
      else {
        $('#header_2').attr('class','card-header bgm-indigo');
        $('#board_links_attributes_2_kind').attr('value',1)
      }
    })

    $('#board_links_attributes_3_url').on('input', function(){
      if($('#board_links_attributes_3_url').val().match(/youtube.com/)){
        $('#board_links_attributes_3_kind').attr('value',2);
        $('#header_3').attr('class','card-header bgm-red');
      }
      else if($('#board_links_attributes_3_url').val().match(/twitter.com/)){
        $('#board_links_attributes_3_kind').attr('value',3)
        $('#header_3').attr('class','card-header bgm-blue');
      }
      else if($('#board_links_attributes_3_url').val().match(/soundcloud.com/)){
        $('#board_links_attributes_3_kind').attr('value',4)
        $('#header_3').attr('class','card-header bgm-orange');
      }
      else if($('#board_links_attributes_3_url').val().match(/.\s./)){
        $('#board_links_attributes_3_kind').attr('value',5)
        $('#header_3').attr('class','card-header bgm-green');
      }
      else {
        $('#header_3').attr('class','card-header bgm-indigo');
        $('#board_links_attributes_3_kind').attr('value',1)
      }
    })

    $('#board_links_attributes_4_url').on('input', function(){
      if($('#board_links_attributes_4_url').val().match(/youtube.com/)){
        $('#board_links_attributes_4_kind').attr('value',2);
        $('#header_4').attr('class','card-header bgm-red');
      }
      else if($('#board_links_attributes_4_url').val().match(/twitter.com/)){
        $('#board_links_attributes_4_kind').attr('value',3)
        $('#header_4').attr('class','card-header bgm-blue');
      }
      else if($('#board_links_attributes_4_url').val().match(/soundcloud.com/)){
        $('#board_links_attributes_4_kind').attr('value',4)
        $('#header_4').attr('class','card-header bgm-orange');
      }
      else if($('#board_links_attributes_4_url').val().match(/.\s./)){
        $('#board_links_attributes_4_kind').attr('value',5)
        $('#header_4').attr('class','card-header bgm-green');
      }
      else {
        $('#header_4').attr('class','card-header bgm-indigo');
        $('#board_links_attributes_4_kind').attr('value',1)
      }
    })

    $('#board_links_attributes_5_url').on('input', function(){
      if($('#board_links_attributes_5_url').val().match(/youtube.com/)){
        $('#board_links_attributes_5_kind').attr('value',2);
        $('#header_5').attr('class','card-header bgm-red');
      }
      else if($('#board_links_attributes_5_url').val().match(/twitter.com/)){
        $('#board_links_attributes_5_kind').attr('value',3)
        $('#header_5').attr('class','card-header bgm-blue');
      }
      else if($('#board_links_attributes_5_url').val().match(/soundcloud.com/)){
        $('#board_links_attributes_5_kind').attr('value',4)
        $('#header_5').attr('class','card-header bgm-orange');
      }
      else if($('#board_links_attributes_5_url').val().match(/.\s./)){
        $('#board_links_attributes_5_kind').attr('value',5)
        $('#header_5').attr('class','card-header bgm-green');
      }
      else {
        $('#header_5').attr('class','card-header bgm-indigo');
        $('#board_links_attributes_5_kind').attr('value',1)
      }
    })

    
//format embedly iframes in cascade to adjust for slow loading times
    setTimeout(function changeIframeWidth(){
      $('.format_iframe > iframe').attr('style', 'border: none; position: relative; visibility: visible; display: block; margin: 10px auto; max-width: 99%;height:100%;').attr('scrolling','yes');
    }, 100);

    setTimeout(function changeIframeWidth(){
      $('.format_iframe > iframe').attr('style', 'border: none; position: relative; visibility: visible; display: block; margin: 10px auto; max-width: 99%;height:100%;').attr('scrolling','yes');
    }, 300);

    setTimeout(function changeIframeWidth(){
      $('.format_iframe > iframe').attr('style', 'border: none; position: relative; visibility: visible; display: block; margin: 10px auto; max-width: 99%;height:100%;').attr('scrolling','yes');
    }, 500);

    setTimeout(function changeIframeWidth(){
      $('.format_iframe > iframe').attr('style', 'border: none; position: relative; visibility: visible; display: block; margin: 10px auto; max-width: 99%;height:100%;').attr('scrolling','yes');
    }, 700);

    setTimeout(function changeIframeWidth(){
      $('.format_iframe > iframe').attr('style', 'border: none; position: relative; visibility: visible; display: block; margin: 10px auto; max-width: 99%;height:100%;').attr('scrolling','yes');
    }, 1000);

    setTimeout(function changeIframeWidth(){
      $('.format_iframe > iframe').attr('style', 'border: none; position: relative; visibility: visible; display: block; margin: 10px auto; max-width: 99%;height:100%;').attr('scrolling','yes');
    }, 1500);

    setTimeout(function changeIframeWidth(){
      $('.format_iframe > iframe').attr('style', 'border: none; position: relative; visibility: visible; display: block; margin: 10px auto; max-width: 99%;height:100%;').attr('scrolling','yes');
    }, 3000);

    setTimeout(function changeIframeWidth(){
      $('.format_iframe > iframe').attr('style', 'border: none; position: relative; visibility: visible; display: block; margin: 10px auto; max-width: 99%;height:100%;').attr('scrolling','yes');
    }, 5000);

//color index page buttons
    $('.index_button_1').attr('class', 'btn bgm-indigo waves-effect waves-button waves-float')
    $('.index_button_2').attr('class', 'btn btn-danger waves-effect waves-button waves-float')
    $('.index_button_3').attr('class', 'btn btn-info waves-effect waves-button waves-float')
    $('.index_button_4').attr('class', 'btn btn-warning waves-effect waves-button waves-float')
    $('.index_button_5').attr('class', 'btn btn-success waves-effect waves-button waves-float')

//dynamically generate color show page card headers
    $('.kind_1').attr('class', 'card-header bgm-indigo')
    $('.kind_2').attr('class', 'card-header bgm-red')
    $('.kind_3').attr('class', 'card-header bgm-blue')
    $('.kind_4').attr('class', 'card-header bgm-orange')


//show link input field on button click
    $('#button_0').click(function(event){
      event.preventDefault();
      $('#button_0').slideUp();
      $('#show_the_field_0').attr('style','visibility: visible;padding-top:100px;')
    })

    $('#button_1').click(function(event){
      event.preventDefault();
      $('#button_1').slideUp();
      $('#show_the_field_1').attr('style','visibility: visible;padding-top:100px;')
    })

    $('#button_2').click(function(event){
      event.preventDefault();
      $('#button_2').slideUp();
      $('#show_the_field_2').attr('style','visibility: visible;padding-top:100px;')
    })

    $('#button_3').click(function(event){
      event.preventDefault();
      $('#button_3').slideUp();
      $('#show_the_field_3').attr('style','visibility: visible;padding-top:100px;')
    })

    $('#button_4').click(function(event){
      event.preventDefault();
      $('#button_4').slideUp();
      $('#show_the_field_4').attr('style','visibility: visible;padding-top:100px;')
    })

    $('#button_5').click(function(event){
      event.preventDefault();
      $('#button_5').slideUp();
      $('#show_the_field_5').attr('style','visibility: visible;padding-top:100px;')
    })

//count characters left in input field
    $('#desc_text_0 > small > input').keyup(function () {
    var left = 35 - $(this).val().length;
    if (left < 0) {
        left = 0;
    }
    $('#counter_0').text(left);
    });

    $('#desc_text_0 > input').keyup(function () {
    var left = 25 - $(this).val().length;
    if (left < 0) {
        left = 0;
    }
    $('#counter_0').text(left);
    });

    $('#desc_text_1 > small > input').keyup(function () {
    var left = 35 - $(this).val().length;
    if (left < 0) {
        left = 0;
    }
    $('#counter_1').text(left);
    });

    $('#desc_text_1 > input').keyup(function () {
    var left = 25 - $(this).val().length;
    if (left < 0) {
        left = 0;
    }
    $('#counter_1').text(left);
    });

    $('#desc_text_2 > small > input').keyup(function () {
    var left = 35 - $(this).val().length;
    if (left < 0) {
        left = 0;
    }
    $('#counter_2').text(left);
    });

    $('#desc_text_2 > input').keyup(function () {
    var left = 25 - $(this).val().length;
    if (left < 0) {
        left = 0;
    }
    $('#counter_2').text(left);
    });

    $('#desc_text_3 > small > input').keyup(function () {
    var left = 35 - $(this).val().length;
    if (left < 0) {
        left = 0;
    }
    $('#counter_3').text(left);
    });

    $('#desc_text_3 > input').keyup(function () {
    var left = 25 - $(this).val().length;
    if (left < 0) {
        left = 0;
    }
    $('#counter_3').text(left);
    });

    $('#desc_text_4 > small > input').keyup(function () {
    var left = 35 - $(this).val().length;
    if (left < 0) {
        left = 0;
    }
    $('#counter_4').text(left);
    });

    $('#desc_text_4 > input').keyup(function () {
    var left = 25 - $(this).val().length;
    if (left < 0) {
        left = 0;
    }
    $('#counter_4').text(left);
    });

    $('#desc_text_5 > small > input').keyup(function () {
    var left = 35 - $(this).val().length;
    if (left < 0) {
        left = 0;
    }
    $('#counter_5').text(left);
    });

    $('#desc_text_5 > input').keyup(function () {
    var left = 25 - $(this).val().length;
    if (left < 0) {
        left = 0;
    }
    $('#counter_5').text(left);
    });

//search function
    $('#search-submit').click(function(event){
      // event.preventDefault();
      var url = window.location.href + "search";
      $.ajax({
      type: 'POST',
      url: url,
      success: function(results){
      },
      dataType: 'JSON'
    })
    })

//save link to user library
      $('#save_button_0').click(function(event){
        var linkId = $('#save_button_0').closest("div").attr("id");
        var data = {linkID: parseInt(linkId)}
        var url = '/add-to-library'
        $.ajax({
          type: 'POST',
          url: url,
          data: data,
          success: function(results){
            $('#save_button_0 > i').attr('class', 'md md-check')
          },
          dataType: 'JSON' 
        })
      })

      $('#save_button_1').click(function(event){
        var linkId = $('#save_button_1').closest("div").attr("id");
        var data = {linkID: parseInt(linkId)}
        var url = '/add-to-library'
        $.ajax({
          type: 'POST',
          url: url,
          data: data,
          success: function(results){
            $('#save_button_1 > i').attr('class', 'md md-check')
          },
          dataType: 'JSON' 
        })
      })

      $('#save_button_2').click(function(event){
        var linkId = $('#save_button_2').closest("div").attr("id");
        var data = {linkID: parseInt(linkId)}
        var url = '/add-to-library'
        $.ajax({
          type: 'POST',
          url: url,
          data: data,
          success: function(results){
            $('#save_button_2 > i').attr('class', 'md md-check')
          },
          dataType: 'JSON' 
        })
      })

      $('#save_button_3').click(function(event){
        var linkId = $('#save_button_3').closest("div").attr("id");
        var data = {linkID: parseInt(linkId)}
        var url = '/add-to-library'
        $.ajax({
          type: 'POST',
          url: url,
          data: data,
          success: function(results){
            $('#save_button_3 > i').attr('class', 'md md-check')
          },
          dataType: 'JSON' 
        })
      })

      $('#save_button_4').click(function(event){
        var linkId = $('#save_button_4').closest("div").attr("id");
        var data = {linkID: parseInt(linkId)}
        var url = '/add-to-library'
        $.ajax({
          type: 'POST',
          url: url,
          data: data,
          success: function(results){
            $('#save_button_4 > i').attr('class', 'md md-check')
          },
          dataType: 'JSON' 
        })
      })

      $('#save_button_5').click(function(event){
        var linkId = $('#save_button_5').closest("div").attr("id");
        var data = {linkID: parseInt(linkId)}
        var url = '/add-to-library'
        $.ajax({
          type: 'POST',
          url: url,
          data: data,
          success: function(results){
            $('#save_button_5 > i').attr('class', 'md md-check')
          },
          dataType: 'JSON' 
        })
      })      


// Button For Writing Text

      $('#text-button_0').click(function(event){
      event.preventDefault();
      $('#button_0').slideUp();
      $('#show_the_field_0').attr('style','visibility: visible;padding-top:100px;')
      $('#board_links_attributes_0_url').attr({placeholder:"Type Your Note Here!", class:"fg-line form-control", style:"padding-top:10px;"})
    });
      $('#text-button_1').click(function(event){
      event.preventDefault();
      $('#button_1').slideUp();
      $('#show_the_field_1').attr('style','visibility: visible;padding-top:100px;')
      $('#board_links_attributes_1_url').attr({placeholder:"Type Your Note Here!", class:"fg-line form-control", style:"padding-top:10px;"})
    });
      $('#text-button_2').click(function(event){
      event.preventDefault();
      $('#button_2').slideUp();
      $('#show_the_field_2').attr('style','visibility: visible;padding-top:100px;')
      $('#board_links_attributes_2_url').attr({placeholder:"Type Your Note Here!", class:"fg-line form-control", style:"padding-top:10px;"})
    });
      $('#text-button_3').click(function(event){
      event.preventDefault();
      $('#button_3').slideUp();
      $('#show_the_field_3').attr('style','visibility: visible;padding-top:100px;')
      $('#board_links_attributes_3_url').attr({placeholder:"Type Your Note Here!", class:"fg-line form-control", style:"padding-top:10px;"})
      });
      $('#text-button_4').click(function(event){
      event.preventDefault();
      $('#button_4').slideUp();
      $('#show_the_field_4').attr('style','visibility: visible;padding-top:100px;')
      $('#board_links_attributes_4_url').attr({placeholder:"Type Your Note Here!", class:"fg-line form-control", style:"padding-top:10px;"})
      });
      $('#text-button_5').click(function(event){
      event.preventDefault();
      $('#button_5').slideUp();
      $('#show_the_field_5').attr('style','visibility: visible;padding-top:100px;')
      $('#board_links_attributes_5_url').attr({placeholder:"Type Your Note Here!", class:"fg-line form-control", style:"padding-top:10px;"})
      });

});